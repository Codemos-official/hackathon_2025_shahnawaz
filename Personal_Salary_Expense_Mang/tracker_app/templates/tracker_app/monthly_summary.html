{% extends 'tracker_app/base.html' %}
{% load static %}

{% block title %}Monthly Summary{% endblock %}

{% block extra_css %}
<style>
.summary-card { border-left: 4px solid #4361ee; }
.health-score-display { margin-top: 20px; }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid mt-4">

<!-- HEADER -->
<div class="card shadow-sm mb-4">
    <div class="card-body d-flex justify-content-between align-items-center">
        <div>
            <h2>
                <i class="fas fa-file-alt text-primary me-2"></i>
                Monthly Financial Summary
            </h2>
            <p class="text-muted mb-0">{{ current_month }}</p>
        </div>
        <button class="btn btn-outline-primary" onclick="window.print()">
            <i class="fas fa-print"></i> Print
        </button>
    </div>
</div>

{% if report %}

<div class="row">

    <!-- EXECUTIVE SUMMARY -->
    <div class="col-lg-8 mb-4">
        <div class="card shadow-sm summary-card h-100">
            <div class="card-header bg-primary text-white">
                <h5><i class="fas fa-chart-line me-2"></i>Executive Summary</h5>
            </div>
            <div class="card-body">
                <ul>
                    <li><b>Total Income:</b> ₹{{ report.total_salary|floatformat:2 }}</li>
                    <li><b>Total Expenses:</b> ₹{{ report.total_expenses|floatformat:2 }}</li>
                    <li><b>Net Savings:</b> ₹{{ report.remaining_balance|floatformat:2 }}</li>
                    <li><b>Savings Rate:</b> {{ report.savings_rate|floatformat:1 }}%</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- FINANCIAL HEALTH SCORE -->
    <div class="col-lg-4 mb-4">
        <div class="card shadow-sm h-100">
            <div class="card-header bg-success text-white">
                <h5><i class="fas fa-heartbeat me-2"></i>Financial Health Score</h5>
            </div>
            <div class="card-body text-center">

                <div class="display-1 fw-bold 
                    {% if report.health_score >= 80 %}text-success
                    {% elif report.health_score >= 60 %}text-warning
                    {% else %}text-danger{% endif %}">
                    {{ report.health_score }}
                </div>

                <p class="text-muted">out of 100</p>

                <span class="badge fs-6
                    {% if report.health_score >= 80 %}bg-success
                    {% elif report.health_score >= 60 %}bg-warning
                    {% else %}bg-danger{% endif %}">
                    {% if report.health_score >= 80 %}
                        Excellent
                    {% elif report.health_score >= 60 %}
                        Good
                    {% else %}
                        Needs Improvement
                    {% endif %}
                </span>

            </div>
        </div>
    </div>

</div>

{% else %}
<div class="alert alert-warning">
    No monthly report available.
</div>
{% endif %}

</div>
{% endblock %}
